<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title>AirShare | Upload</title>
		<link rel="stylesheet" href="{{ url_for('static', filename='upload.css') }}">
	</head>
	<body>
		<div class="title-container">
			<h2 class="title">Upload Your File</h2>
			<form action="/upload" method="post" enctype="multipart/form-data" class="forms">
				<input type="file" name="file" class="file" id="file" required hidden>
				<label for="file" class="upload-btn">Choose File</label>
        <input type="text" name="text" class="upload-txt" placeholder="Send to...">
				<button type="submit" class="submit-btn">Submit</button>
        <p class="error-msg">
          {% with messages = get_flashed_messages() %}
            {% if messages %}
              {{ messages[0] }}
            {% endif %}
          {% endwith %}
        </p>
			</form>
		</div>

		<div class="bottom-container">
      <h3 class="bottom-title">Uploaded File: <br><span id="uploaded-file">{{file}}</span></h3>
      <script>
      const fileInput = document.getElementById("file");
      const uploadedFile = document.getElementById("uploaded-file");

      fileInput.addEventListener("change", () => {
          if(fileInput.files.length > 0){
              uploadedFile.textContent = fileInput.files[0].name;
          } else {
              uploadedFile.textContent = "";
          }
      });
      </script>
			<h3 class="bottom-title upload-txt2">Your Uploaded Files:</h3>
        <div class="file-list">
            {% set max_count = 6 %}

            {% if files %}

                {% for f in files[-max_count:] | reverse %}
                <div class="file-item">
                    ðŸ“„ {{ f.name }}
                </div>
                {% endfor %}

                {% if files | length > max_count %}
                    <p class="message show-more">... {{ files | length - max_count }} more files hidden</p>
                {% endif %}

            {% else %}
                <p class="message">You have not uploaded any files yet!</p>
            {% endif %}
        </div>
      </div>
		</div>
	</body>
</html>
